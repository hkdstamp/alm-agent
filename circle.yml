---
environment:
  GOROOT: $HOME/go
  GODIST: "go1.7.1.linux-amd64.tar.gz"
  IMPORT_PATH: "github.com/$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME"
post:
  - mkdir -p download
  - test -e download/$GODIST || curl -o download/$GODIST https://storage.googleapis.com/golang/$GODIST
  - sudo tar -C $HOME -xzf download/$GODIST

dependencies:
  cache_directories:
    - "/home/ubuntu/download"
  override:
    - go get github.com/Masterminds/glide
    - glide install

test:
  override:
    - go test -v -race $(glide novendor)
